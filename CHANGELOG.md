# QieYu 切语日志库 - 更新日志

## [1.1.0] - 2026-02-15

### 新增功能

#### 1. 消息提醒系统
- **消息通知中心**：整合消息提醒到通知中心，显示未读消息数量
- **实时消息提醒**：每3秒自动刷新未读消息数量
- **消息跳转功能**：点击通知中心的消息可直接跳转到对应好友的聊天页面
- **已读功能**：进入聊天页面后自动标记消息为已读

#### 2. 主题色系统完善
- **12种主题色**：紫罗兰、天空蓝、翠绿、玫瑰红、琥珀橙、青色、粉色、靛蓝、teal、活力橙、中国红、石墨灰
- **自定义主题色**：支持选择任意颜色作为主题色
- **实时切换**：主题切换后立即生效并保存

#### 3. 数据管理功能
- **导出备份**：支持导出学习日志为 JSON 文件
- **导入恢复**：支持从 JSON 文件导入学习日志
- **数据迁移**：方便用户更换设备或备份数据

#### 4. 实时数据刷新
- **自动轮询**：每10秒自动刷新日志列表
- **页面可见性检测**：切换回页面时自动刷新
- **跨标签页同步**：多标签页间数据实时同步
- **操作后即时更新**：删除、编辑、点赞等操作后立即更新界面

#### 5. 收藏功能优化
- **取消收藏**：在"我的收藏"页面可直接取消收藏
- **实时同步**：收藏列表实时更新

### 优化改进

#### 1. 数据库优化
- **聊天消息表**：新增 `is_read`、`read_at`、`is_deleted_by_sender`、`is_deleted_by_recipient` 字段
- **消息通知表**：新增 `sys_message_notification` 表用于消息提醒
- **索引优化**：添加多个索引提升查询性能

#### 2. 界面优化
- **删除确认**：删除日志后自动返回主页
- **编辑提示**：编辑成功后显示"编辑成功"提示
- **创建提示**：创建成功后显示"创建成功"提示
- **错误处理**：显示具体的错误信息

#### 3. 性能优化
- **本地状态更新**：操作后先更新本地状态，再后台同步
- **减少不必要的刷新**：优化刷新逻辑，减少API调用

### 修复问题

#### 1. Bug修复
- **删除失败**：修复了删除接口返回 204 导致的 JSON 解析错误
- **主题色不生效**：修复了部分主题色切换不生效的问题
- **数据不刷新**：修复了需要手动刷新才能看到新数据的问题

#### 2. 数据库修复
- **Admin账户**：添加默认 admin 账户（用户名: admin, 密码: admin123）
- **字段缺失**：补充缺失的数据库字段

### 技术更新

#### 1. API新增
- `GET /api/messages/unread/count` - 获取未读消息数量
- `GET /api/messages/unread` - 获取未读消息列表
- `POST /api/messages/read` - 标记消息为已读

#### 2. 组件更新
- `Sidebar` - 新增消息通知功能
- `ChatView` - 支持初始联系人ID
- `SettingsView` - 完善主题色选择
- `ProfileView` - 支持取消收藏

---

## [1.0.0] - 2026-02-01

### 初始版本

#### 核心功能
- **用户系统**：注册、登录、个人资料管理
- **日志管理**：创建、编辑、删除学习日志
- **日志类型**：支持 ComfyUI、Midjourney、Fooocus 等多种类型
- **分类管理**：自定义分类标签
- **点赞收藏**：支持点赞和收藏日志
- **好友系统**：添加好友、好友请求
- **聊天功能**：公共聊天室和私聊
- **AI助手**：集成 AI 聊天功能
- **主题切换**：支持亮色/暗色模式
- **响应式设计**：支持移动端和桌面端

#### 管理功能
- **用户管理**：管理员可管理用户账户
- **审计日志**：记录系统操作日志
- **数据统计**：查看系统统计数据

---

## 更新计划

### 未来版本

#### [1.2.0] 计划功能
- [ ] 消息已读回执显示
- [ ] 聊天记录搜索
- [ ] 文件传输功能
- [ ] 语音消息
- [ ] 消息撤回

#### [1.3.0] 计划功能
- [ ] 日志模板
- [ ] 批量导入导出
- [ ] 数据可视化
- [ ] 学习统计

---

## 贡献者

- 开发团队：QieYu Team

## 许可证

MIT License
